<head>
  <title>Pokemon Type Matchups</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bangers&family=Rubik:wght@300&display=swap">
  <style>
    html {
      background-color: #121212;
      color: #bdbdbd;
      color: #a0a0a0;
      user-select: none;
      font-size: 18px;
    }
    
    a {
      color: #00bfff;
    }
    
    #main {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      
      margin: auto;
      
      font-family: Rubik, sans-serif;
      font-size: 1rem;
    }
    
    .title {
      font-weight: bold;
      font-size: 2rem;
    }
    
    .subtitle {
      font-weight: bold;
      font-size: 1.25rem;
    }
    
    /* Headers */
    
    .header {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: space-around;
      padding: 1rem;
    }
    
    .label {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      flex-direction: column;
      
      box-sizing: border-box;
      border-top: solid 1px rgba(0, 0, 0, 0.0);
      border-left: solid 1px rgba(0, 0, 0, 0.0);
    }
    
    /* Attack Header */
    
    #attacks {
      display: grid;
      grid-template-columns: auto 1fr;
      grid-template-rows: 1fr;
      
      font-weight: bold;
    }
    
    #attacks .header {
      writing-mode: vertical-lr;
    }
    
    #attacks .labels {
      display: grid;
      grid-template-columns: 1fr;
      grid-template-rows: repeat(18, 1fr);
    }
    
    #attacks .label {
      padding: 0rem 1rem;
    }
    
    /* Defender Header */
    
    #defenders {
      display: grid;
      grid-template-columns: 1fr;
      grid-template-rows: auto 1fr;
      
      font-weight: bold;
    }
    
    #defenders .labels {
      display: grid;
      grid-template-columns: repeat(18, 1fr);
      grid-template-rows: 1fr;
    }
    
    #defenders .label {
      padding: 1rem 0rem;
      writing-mode: vertical-lr;
    }
    
    /* Grid */
    
    #grid {
      display: grid;
      grid-template-columns: repeat(18, 1fr);
      grid-template-rows: repeat(18, 1fr);
      
      background-color: rgba(255, 255, 255, 0.55); 
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: auto 18fr;
      grid-template-rows: auto 18fr;
      
      background-color: rgba(255, 255, 255, 0.20);
      border-bottom-left-radius: 0.5em;
      border-top-left-radius: 0.5em;
      border-top-right-radius: 0.5em;
      
      color: #b3b3b3;
    }
    
    .cell {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      
      aspect-ratio: 1 / 1;
      height: 2.25rem;
      
      box-sizing: border-box;
      border-top: solid 1px rgba(0, 0, 0, 0.1);
      border-left: solid 1px rgba(0, 0, 0, 0.1);
      
      font-family: 'Bangers', cursive;
      font-size: 1.5rem;
    }
    
    /* Cell Effectiveness */
    
    .cell.immune {
      color: #545454;
    }
    
    .cell.resist {
      color: #892a2a;
      font-size: 1rem;
    }
    
    .cell.normal {
      color: #767676;
    }
    
    .cell.weak {
      color: #2a892a;
    }
    
    /* Hovering */
    
    .hovered-related-defender {
      background-color: rgba(0, 0, 255, 0.25);
    }
    
    .hovered-related-attack {
      background-color: rgba(255, 0, 0, 0.25);
    }
    
    .hovered {
      background-color: rgba(255, 255, 255, 0.25);
    }
    
    /* Highlighting */
    
    .label.highlight {
      background-color: rgba(255, 255, 255, 1.0);
    }
    
    .cell.highlight {
      background-color: rgba(255, 255, 255, 1.0);
    }
    
    .related-defender {
      background-color: rgba(0, 0, 255, 1.0);
    }
    
    .related-attack {
      background-color: rgba(255, 0, 0, 1.0);
    }
    
    .related-defender.related-attack:not(.highlight) {
      background-color: rgba(255, 0, 255, 1.0);
    }
    
    /* Hovering + Highlighting */
    
    .hovered-related-defender.related-attack,
    .hovered-related-attack.related-defender {
      background-color: rgba(255, 0, 255, 0.75);
    }
    
    
    
    
    
    
    
    
    /*.related {
      background-color: rgba(0, 191, 255, 0.25);
      
      box-sizing: border-box;
      border-top: solid 1px rgba(0, 0, 0, 0.0);
      border-left: solid 1px rgba(0, 0, 0, 0.0);
    }*/
    
    /*.selected {
      background-color: rgba(0, 191, 255, 0.85);
      
      box-sizing: border-box;
      border-top: solid 1px rgba(0, 0, 0, 0.0);
      border-left: solid 1px rgba(0, 0, 0, 0.0);
    }*/
    
    /*.selected.label {
      color: #2f2f2f;
    }*/
  </style>
  <script type="text/javascript">
  /*
    Order: Normal Fire Water Electric Grass Ice Fighting Poison Ground Flying Psychic Bug Rock Ghost Dragon Dark Steel Fairy
  */

  const matchups = [{
    type: 'Normal',
    immuneTo: ['Ghost'],
    resistTo: [],
    weakTo: ['Fighting']
  }, {
    type: 'Fire',
    immuneTo: [],
    resistTo: ['Fire', 'Grass', 'Ice', 'Bug', 'Steel', 'Fairy'],
    weakTo: ['Water', 'Ground', 'Rock']
  }, {
    type: 'Water',
    immuneTo: [],
    resistTo: ['Fire', 'Water', 'Ice', 'Steel'],
    weakTo: ['Electric', 'Grass']
  }, {
    type: 'Electric',
    immuneTo: [],
    resistTo: ['Electric', 'Flying', 'Steel'],
    weakTo: ['Ground']
  }, {
    type: 'Grass',
    immuneTo: [],
    resistTo: ['Water', 'Electric', 'Grass', 'Ground'],
    weakTo: ['Fire', 'Ice', 'Poison', 'Flying', 'Bug']
  }, {
    type: 'Ice',
    immuneTo: [],
    resistTo: ['Ice'],
    weakTo: ['Fire', 'Fighting', 'Rock', 'Steel']
  }, {
    type: 'Fighting',
    immuneTo: [],
    resistTo: ['Bug', 'Rock', 'Dark'],
    weakTo: ['Flying', 'Psychic', 'Fairy']
  }, {
    type: 'Poison',
    immuneTo: [],
    resistTo: ['Grass', 'Fighting', 'Poison', 'Bug', 'Fairy'],
    weakTo: ['Ground', 'Psychic']
  }, {
    type: 'Ground',
    immuneTo: ['Electric'],
    resistTo: ['Poison', 'Rock'],
    weakTo: ['Water', 'Grass', 'Ice']
  }, {
    type: 'Flying',
    immuneTo: ['Ground'],
    resistTo: ['Grass', 'Fighting', 'Bug'],
    weakTo: ['Electric', 'Ice', 'Rock']
  }, {
    type: 'Psychic',
    immuneTo: [],
    resistTo: ['Fighting', 'Psychic'],
    weakTo: ['Bug', 'Ghost', 'Dark']
  }, {
    type: 'Bug',
    immuneTo: [],
    resistTo: ['Grass', 'Fighting', 'Ground'],
    weakTo: ['Fire', 'Flying', 'Rock']
  }, {
    type: 'Rock',
    immuneTo: [],
    resistTo: ['Normal', 'Fire', 'Poison', 'Flying'],
    weakTo: ['Water', 'Grass', 'Fighting', 'Ground', 'Steel']
  }, {
    type: 'Ghost',
    immuneTo: ['Normal', 'Fighting'],
    resistTo: ['Poison', 'Bug'],
    weakTo: ['Ghost', 'Dark']
  }, {
    type: 'Dragon',
    immuneTo: [],
    resistTo: ['Fire', 'Water', 'Electric', 'Grass'],
    weakTo: ['Ice', 'Dragon', 'Fairy']
  }, {
    type: 'Dark',
    immuneTo: ['Psychic'],
    resistTo: ['Ghost', 'Dark'],
    weakTo: ['Fighting', 'Bug', 'Fairy']
  }, {
    type: 'Steel',
    immuneTo: ['Poison'],
    resistTo: ['Normal', 'Grass', 'Ice', 'Flying', 'Psychic', 'Bug', 'Rock', 'Dragon', 'Steel', 'Fairy'],
    weakTo: ['Fire', 'Fighting', 'Ground']
  }, {
    type: 'Fairy',
    immuneTo: ['Dragon'],
    resistTo: ['Fighting', 'Bug', 'Dark'],
    weakTo: ['Poison', 'Steel']
  }];

  let highlight = null;
  let lastHover = null;

  let highlights = {
    attacks: new Set(),
    defenders: new Set(),
    matchups: new Set()
  };
  
  /* Element generation */
  function generateAttacks() {
    let elParent = document.querySelector('#attacks .labels');

    matchups.forEach((attack) => {
      let classList = `label attack-${attack.type}`;
      
      let newCell = document.createElement('div');
      newCell.className = classList;
      newCell.innerHTML = attack.type;

      newCell.addEventListener('mouseover', (e) => attackHovered(attack.type));
      newCell.addEventListener('mouseout', (e) => elementUnhovered());
      newCell.addEventListener('mousedown', (e) => {
        if (e.button === 0) {
          attackClicked(attack.type)
        }
      });

      elParent.appendChild(newCell);
    });
  }
  
  function generateDefenders() {
    let elParent = document.querySelector('#defenders .labels');

    matchups.forEach((defender) => {
      let classList = `label defender-${defender.type}`;
      
      let newCell = document.createElement('div');
      newCell.className = classList;
      newCell.innerHTML = defender.type;

      newCell.addEventListener('mouseover', (e) => defenderHovered(defender.type));
      newCell.addEventListener('mouseout', (e) => elementUnhovered());
      newCell.addEventListener('mousedown', (e) => {
        if (e.button === 0) {
          defenderClicked(defender.type)
        }
      });

      elParent.appendChild(newCell);
    });
  }

  function generateGrid() {
    let elParent = document.getElementById('grid');

    matchups.forEach((attack) => {
      matchups.forEach((defender) => {
        let classList = `attack-${attack.type} defender-${defender.type}`;

        let newCell = document.createElement('div');
        newCell.className = `cell ${classList}`;

        if (defender.immuneTo.indexOf(attack.type) > -1) {
          newCell.innerHTML = '0x';
          newCell.classList.add('immune');
        } else if (defender.resistTo.indexOf(attack.type) > -1) {
          newCell.innerHTML = '1/2x';
          newCell.classList.add('resist');
        } else if (defender.weakTo.indexOf(attack.type) > -1) {
          newCell.innerHTML = '2x';
          newCell.classList.add('weak');
        } else {
          newCell.classList.add('normal');
        }

        newCell.addEventListener('mouseover', (e) => matchupHovered(attack.type, defender.type));
        newCell.addEventListener('mouseout', (e) => elementUnhovered());
        newCell.addEventListener('mousedown', (e) => {
          if (e.button === 0) {
            matchupClicked(attack.type, defender.type)
          }
        });

        elParent.appendChild(newCell);
      });
    });
  }

  /* Clicking */
  document.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    document.querySelectorAll('.highlight').forEach((el) => el.classList.remove('highlight'));
    document.querySelectorAll('.related-attack').forEach((el) => el.classList.remove('related-attack'));
    document.querySelectorAll('.related-defender').forEach((el) => el.classList.remove('related-defender'));
    
    highlights = {
      attacks: new Set(),
      defenders: new Set(),
      matchups: new Set()
    };
  });
  
  function attackClicked(attack) {
    let labelEl = document.querySelector(`#attacks .attack-${attack}`);
    if (highlights.attacks.has(attack)) {
      // Already highlighted
      
      // Record highlight removal
      highlights.attacks.delete(attack);
      labelEl.classList.remove('highlight');
      
      // Check if any matchups coincide with this label
      let matchupObj = Array.from(highlights.matchups)
        .find((matchup) => matchup.attack === attack);
      
      if (!matchupObj) {
        // Remove related-attack class from all related cells that aren't highlighted by a matchup
        let cellsEl = document.querySelectorAll(`#grid .attack-${attack}`);
        cellsEl.forEach((el) => {
          el.classList.remove('related-attack');
        });
      }
    } else {
      // Not highlighted yet
      
      // Record highlight
      highlights.attacks.add(attack);
      labelEl.classList.add('highlight');
      
      // Add related-attack class to all related cells
      let cellsEl = document.querySelectorAll(`#grid .attack-${attack}`);
      cellsEl.forEach((el) => {
        el.classList.add('related-attack');
      });
    }
  }

  function defenderClicked(defender) {
    let labelEl = document.querySelector(`#defenders .defender-${defender}`);
    if (highlights.defenders.has(defender)) {
      // Already highlighted
      
      // Record highlight removal
      highlights.defenders.delete(defender);
      labelEl.classList.remove('highlight');
      
      // Check if any matchups coincide with this label
      let matchupObj = Array.from(highlights.matchups)
        .find((matchup) => matchup.defender === defender);
      
      if (!matchupObj) {
        // Remove related-defender class from all related cells that aren't highlighted by a matchup
        let cellsEl = document.querySelectorAll(`#grid .defender-${defender}`);
        cellsEl.forEach((el) => {
          el.classList.remove('related-defender');
        });
      }
    } else {
      // Not highlighted yet
      
      // Record highlight
      highlights.defenders.add(defender);
      labelEl.classList.add('highlight');
      
      // Add related-defender class to all related cells
      let cellsEl = document.querySelectorAll(`#grid .defender-${defender}`);
      cellsEl.forEach((el) => {
        el.classList.add('related-defender');
      });
    }
  }

  function matchupClicked(attack, defender) {
    let cellEl = document.querySelector(`#grid .attack-${attack}.defender-${defender}`);
    
    // Need specific object reference for set removal
    let matchupObj = Array.from(highlights.matchups)
      .find((matchup) => matchup.attack === attack && matchup.defender === defender);
    
    if (matchupObj) {
      // Already highlighted
      
      // Record highlight removal
      highlights.matchups.delete(matchupObj);
      cellEl.classList.remove('highlight');
      
      // Get a conflicting attack matchup
      let attackMatchupObj = Array.from(highlights.matchups)
        .find((matchup) => matchup.attack === attack);
      
      if (!attackMatchupObj) {
        // Remove related-attack class from attack label if another matchup doesn't match it
        let labelEl = document.querySelector(`#attacks .attack-${attack}`);
        labelEl.classList.remove('related-attack');
      }
      
      if (!highlights.attacks.has(attack) && !attackMatchupObj) {
        // Remove related-attack class from all related cells that aren't highlighted by a matchup
        let attackCellsEl = document.querySelectorAll(`#grid .attack-${attack}`);
        attackCellsEl.forEach((el) => {
          el.classList.remove('related-attack');
        });
      }
      
      // Get a conflicting defender matchup
      let defenderMatchupObj = Array.from(highlights.matchups)
        .find((matchup) => matchup.defender === defender);
      
      if (!defenderMatchupObj) {
        // Remove related-defender class from defender label if another matchup doesn't match it
        let labelEl = document.querySelector(`#defenders .defender-${defender}`);
        labelEl.classList.remove('related-defender');
      }
      
      if (!highlights.defenders.has(defender) && !defenderMatchupObj) {
        // Remove related-defender class from all related cells that aren't highlighted by a matchup
        let defenderCellsEl = document.querySelectorAll(`#grid .defender-${defender}`);
        defenderCellsEl.forEach((el) => {
          el.classList.remove('related-defender');
        });
      }
    } else {
      // Not highlighted yet
      cellEl.classList.add('highlight');
      
      // Add related-attack class to attack label
      let attackLabelEl = document.querySelector(`#attacks .attack-${attack}`);
      attackLabelEl.classList.add('related-attack');
      
      // Add related-attack class to all attack related cells
      let attacksEl = document.querySelectorAll(`#grid .attack-${attack}:not(.defender-${defender}`);
      attacksEl.forEach((el) => {
        el.classList.add('related-attack');
      });
      
      // Add related-defender class to defender label
      let defenderLabelEl = document.querySelector(`#defenders .defender-${defender}`);
      defenderLabelEl.classList.add('related-defender');
      
      // Add related-defender class to all defender related cells
      let defendersEl = document.querySelectorAll(`#grid .defender-${defender}:not(.attack-${attack}`);
      defendersEl.forEach((el) => {
        el.classList.add('related-defender');
      });
      
      // Record highlight
      highlights.matchups.add({attack: attack, defender: defender});
    }
  }
  
  /* Hovering */
  function attackHovered(attack) {
    // Highlight the label
    let labelEl = document.querySelector(`#attacks .attack-${attack}`);
    labelEl.classList.add('hovered');
    
    // Highlight the related cells
    let cellsEl = document.querySelectorAll(`#grid .attack-${attack}`);
      cellsEl.forEach((el) => {
        el.classList.add('hovered-related-attack');
      });
  }
  
  function defenderHovered(defender) {
    // Highlight the label
    let labelEl = document.querySelector(`#defenders .defender-${defender}`);
    labelEl.classList.add('hovered');
    
    // Highlight the related cells
    let cellsEl = document.querySelectorAll(`#grid .defender-${defender}`);
      cellsEl.forEach((el) => {
        el.classList.add('hovered-related-defender');
      });
  }
  
  function matchupHovered(attack, defender) {
    // Highlight the label
    let cellEl = document.querySelector(`#grid .attack-${attack}.defender-${defender}`);
    cellEl.classList.add('hovered');
    
    // Highlight the attack related cells
    let attackerCellsEl = document.querySelectorAll(`#grid .attack-${attack}`);
      attackerCellsEl.forEach((el) => {
        el.classList.add('hovered-related-attack');
      });
    
    // Highlight the defender related cells
    let defenderCellsEl = document.querySelectorAll(`#grid .defender-${defender}`);
    defenderCellsEl.forEach((el) => {
      el.classList.add('hovered-related-defender');
    });
  }
  
  /* Unhovering */
  function elementUnhovered() {
    document.querySelectorAll('.hovered').forEach((el) => el.classList.remove('hovered'));
    document.querySelectorAll('.hovered-related-attack')
      .forEach((el) => el.classList.remove('hovered-related-attack'));
    document.querySelectorAll('.hovered-related-defender')
      .forEach((el) => el.classList.remove('hovered-related-defender'));
  }
  </script>
</head>

<body>
  <div id="main">
    <div class="title">
      Type Matchups
    </div>
    <div class="subtitle">
      Based on Scarlet/Violet
    </div>
    <div class="grid-container">
      <div></div>
      <div id="defenders">
        <div class="header"><span>Defender</span><span>Defender</span></div>
        <div class="labels">
          <script type="text/javascript">
            generateDefenders();
          </script>
        </div>
      </div>
      <div id="attacks">
        <div class="header"><span>Attack</span><span>Attack</span></div>
        <div class="labels">
          <script type="text/javascript">
            generateAttacks();
          </script>
        </div>
      </div>
      <div id="grid">
        <script type="text/javascript">
          generateGrid();
        </script>
      </div>
    </div>
    <div>
      <b>Hover</b> over types/matchups to highlight -
      <b>Left click</b> to freeze highlights (You can have multiple!) -
      <b>Right click</b> to unfreeze highlights
    </div>
    <div>
      Coded by <a href="https://twitch.tv/isoitiro">Isoitiro</a>
    </div>
  </div>
</body>